{"code":"!function(t){var e={};function n(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){\"undefined\"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var i in t)n.d(a,i,function(e){return t[e]}.bind(null,i));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"/\",n(n.s=7)}([function(t,e){t.exports=self.AFAppX},function(t,e,n){t.exports=!n(6)(function(){return 7!=Object.defineProperty({},\"a\",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t){return\"object\"===typeof t?null!==t:\"function\"===typeof t}},function(t,e){var n=t.exports=\"undefined\"!=typeof window&&window.Math==Math?window:\"undefined\"!=typeof self&&self.Math==Math?self:Function(\"return this\")();\"number\"==typeof __g&&(__g=n)},function(t,e){var n=t.exports={version:\"2.5.7\"};\"number\"==typeof __e&&(__e=n)},function(t,e,n){var a=n(30),i=n(31),o=n(33),s=Object.defineProperty;e.f=n(1)?Object.defineProperty:function(t,e,n){if(a(t),e=o(e,!0),a(n),i)try{return s(t,e,n)}catch(t){}if(\"get\"in n||\"set\"in n)throw TypeError(\"Accessors not supported!\");return\"value\"in n&&(t[e]=n.value),t}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){t.exports=n(8)},function(t,e,n){\"use strict\";function a(){n(12),n(13),n(14),n(15),n(16),n(17),n(18),n(19),n(20),n(21),n(36)}n(9),n(11),self.bootstrapApp?self.bootstrapApp({success:a}):a()},function(t,e,n){\"use strict\";(function(t){var e=\"undefined\"!==typeof t?t:self;e.appXRuntimeConfig={},e.appXAppJson={app:{$homepage:\"page/kownledge/index\"}}}).call(this,n(10))},function(t,e){var n;n=function(){return this}();try{n=n||Function(\"return this\")()||(0,eval)(\"this\")}catch(t){\"object\"===typeof window&&(n=window)}t.exports=n},function(t,e,n){\"use strict\";importScripts(\"https://appx/af-appx.worker.min.js\")},function(t,e,n){\"use strict\";var a=n(0);a.bridge,a.bridge;(0,a.App)({globalData:{userInfo:{id:\"\",name:\"\",position:\"\",avatar:\"\"},host:\"http://yangfan.vaiwan.com/\",corpId:\"\"},onLaunch:function(t){t.query,this.globalData.corpId=t.query.corpId},onShow:function(t){}})},function(t,e,n){\"use strict\";var a=n(0),i=(a.bridge,a.bridge,a.WorkerComponent||function(){});a.$global.currentComponentConfig={is:\"/mini-ddui/es/grid/index\",usingComponents:{}},i({data:{bottomIndex:0},props:{columnNum:3,circular:!1,list:[],onGridItemClick:function(){},hasLine:!0},didMount:function(){var t=this.props,e=t.list,n=t.columnNum,a=e.length/n;this.setData({bottomIndex:Math.floor(a)===a?(a-1)*n:Math.floor(a)*n})},methods:{onGridItemClick:function(t){this.props.onGridItemClick({detail:{index:t.target.dataset.index}})}}})},function(t,e,n){\"use strict\";var a=n(0),i=(a.bridge,a.bridge,a.WorkerComponent||function(){});a.$global.currentComponentConfig={is:\"/mini-ddui/es/search-bar/index\",usingComponents:{}},i({props:{className:\"\",placeholder:\"\",focus:!1},data:{_value:\"\",focus:!1},didMount:function(){this.setData({_value:this.props.hasOwnProperty(\"value\")?this.props.value:\"\",focus:this.props.focus})},didUpdate:function(){this.props.hasOwnProperty(\"value\")&&this.props.value!==this.data._value&&this.setData({_value:this.props.value})},methods:{handleInput:function(t){var e=t.detail.value;this.props.hasOwnProperty(\"value\")||this.setData({_value:e}),this.props.onInput&&this.props.onInput(e)},handleClear:function(){this.setData({focus:!0}),this.props.hasOwnProperty(\"value\")||this.setData({_value:\"\"}),this.doClear()},doClear:function(){this.props.onClear&&this.props.onClear(\"\"),this.props.onChange&&this.props.onChange(\"\")},handleFocus:function(){this.setData({focus:!0}),this.props.onFocus&&this.props.onFocus()},handleBlur:function(){this.setData({focus:!1}),this.props.onBlur&&this.props.onBlur()},handleCancel:function(){this.props.hasOwnProperty(\"value\")||this.setData({_value:\"\"}),this.props.onCancel?this.props.onCancel():this.doClear()},handleConfirm:function(t){var e=t.detail.value;this.props.onSubmit&&this.props.onSubmit(e)},handleBack:function(t){this.props.onBack&&this.props.onBack()},scan:function(){dd.scan({type:\"qr\",success:function(t){dd.navigateTo({url:\"/page/kownledge/doc-detial/doc-detial?id=\"+t.code})},fail:function(t){dd.alert({content:\"\\u83b7\\u53d6\\u6570\\u636e\\u5931\\u8d25\\uff0c\\u8bf7\\u91cd\\u8bd5\"})}})}}})},function(t,e,n){\"use strict\";var a=n(0),i=(a.bridge,a.bridge,a.WorkerComponent||function(){});a.$global.currentComponentConfig={is:\"/mini-ddui/es/card/index\",usingComponents:{}},i({props:{title:\"\",onClick:function(){},info:\"\"},methods:{onCardClick:function(){var t=this.props,e=t.info;(0,t.onClick)({info:e})}}})},function(t,e,n){\"use strict\";var a=n(0),i=(a.bridge,a.bridge),o=a.WorkerComponent||function(){};a.$global.currentComponentConfig={is:\"/mini-ddui/es/tabs/index\",usingComponents:{}},o({props:{className:\"\",tabBarUnderlineColor:\"#3296fa\",tabBarActiveTextColor:\"#3296fa\",tabBarInactiveTextColor:\"#191f25\",tabBarBackgroundColor:\"#ffffff\",showPlus:!1,fixed:!0},data:{scrollInit:0,current:0,windowWidth:0,tabWidth:.25},didMount:function(){var t=this,e=this.props.tabs;i.getSystemInfo({success:function(n){t.setData({windowWidth:n.windowWidth,tabWidth:e.length>3?.25:1/e.length})}})},methods:{handleSwiperChange:function(t){var e=t.detail.current;this.moveScrollBar(e),this.props.onChange&&this.props.onChange({index:e}),this.setData({current:e})},handleTabClick:function(t){var e=t.target.dataset.index;this.moveScrollBar(e),this.props.onTabClick&&this.props.onTabClick({index:e}),this.setData({current:e})},handlePlusClick:function(){this.props.onPlusClick&&this.props.onPlusClick()},moveScrollBar:function(t){var e=this.data,n=e.windowWidth,a=e.tabWidth,i=t*n*a;i=t<=2?0:(t-2)*n*a,this.setData({scrollInit:i})}}})},function(t,e,n){\"use strict\";var a=n(0),i=(a.bridge,a.bridge,a.WorkerComponent||function(){});a.$global.currentComponentConfig={is:\"/mini-ddui/es/tabs/tab-content/index\",usingComponents:{}},i({})},function(t,e,n){\"use strict\";var a=n(0),i=(a.bridge,a.bridge,a.WorkerComponent||function(){});a.$global.currentComponentConfig={is:\"/mini-ddui/es/list/index\",usingComponents:{}},i({props:{className:\"\"}})},function(t,e,n){\"use strict\";var a=n(0),i=(a.bridge,a.bridge,a.WorkerComponent||function(){});a.$global.currentComponentConfig={is:\"/mini-ddui/es/list/list-item/index\",usingComponents:{}},i({props:{className:\"\",align:!1,disabled:!1,multipleLine:!1,wrap:!1},methods:{onItemTap:function(t){var e=this.props,n=e.onClick,a=e.disabled;n&&!a&&n({index:t.target.dataset.index})}}})},function(t,e,n){\"use strict\";var a=n(0);a.bridge,a.bridge;a.$global.currentPageConfig={pagePath:\"page/kownledge/index\",usingComponents:{grid:\"/mini-ddui/es/grid/index\",\"search-bar\":\"/mini-ddui/es/search-bar/index\",card:\"/mini-ddui/es/card/index\"}};var i=(0,a.getApp)();(0,a.Page)({data:{userInfo:{id:\"\",name:\"\",position:\"\",avatar:\"\"},gridList:{}},onLoad:function(t){this.loginSys()},loginSys:function(){var t=this;\"\"==i.globalData.userInfo.id?(dd.showLoading(),dd.getAuthCode({success:function(e){dd.httpRequest({url:i.globalData.host+\"api/services/app/Employee/GetDingDingUserByCodeAsync\",method:\"Get\",data:{code:e.authCode,appId:10},dataType:\"json\",success:function(e){i.globalData.userInfo=e.data.result,t.setData({userInfo:i.globalData.userInfo}),t.getCategoryList()},fail:function(t){dd.alert({content:\"\\u83b7\\u53d6\\u7528\\u6237\\u4fe1\\u606f\\u5f02\\u5e38\"+JSON.stringify(t),buttonText:\"\\u786e\\u5b9a\"})},complete:function(t){dd.hideLoading()}})}})):(this.setData({userInfo:i.globalData.userInfo}),this.getCategoryList())},handleFocus:function(){dd.navigateTo({url:\"./category-detial/category-detial\"})},onItemClick:function(t){var e=t.detail.index,n=this.data.gridList[e].id;dd.navigateTo({url:\"./category-detial/category-detial?id=\"+n})},getCategoryList:function(){var t=this;dd.httpRequest({url:i.globalData.host+\"/api/services/app/DocCategory/GetCategoryListAsync\",method:\"Get\",dataType:\"json\",data:{host:i.globalData.host,userId:i.globalData.userInfo.id},success:function(e){t.setData({gridList:e.data.result})},fail:function(t){dd.alert({content:\"\\u83b7\\u53d6\\u6570\\u636e\\u5931\\u8d25\\uff0c\\u8bf7\\u91cd\\u8bd5\"})},complete:function(t){dd.hideLoading()}})},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},onTitleClick:function(){},onPullDownRefresh:function(){},onReachBottom:function(){},onShareAppMessage:function(){}})},function(t,e,n){\"use strict\";var a,i,o=n(22),s=(a=o)&&a.__esModule?a:{default:a},r=n(0);r.bridge,r.bridge;r.$global.currentPageConfig={pagePath:\"page/kownledge/category-detial/category-detial\",usingComponents:{card:\"/mini-ddui/es/card/index\",\"search-bar\":\"/mini-ddui/es/search-bar/index\",tabs:\"/mini-ddui/es/tabs/index\",\"tab-content\":\"/mini-ddui/es/tabs/tab-content/index\"}};var d=(0,r.getApp)();(0,r.Page)((i={data:{id:null,input:\"\",docList:[],tabs:{},pageSize:6,pageIndex:1,pageSearchIndex:1,tempTabIndex:0,pullType:\"\"},onLoad:function(t){this.setData({docList:[]}),t.id&&(this.setData({id:t.id}),this.getTabs())},getSearch:function(t){var e=this;dd.showLoading(),t||(t=this.data.id),dd.httpRequest({url:d.globalData.host+\"api/services/app/Document/GetDocListByInputAsync\",method:\"Get\",dataType:\"json\",data:{input:this.data.input,catId:t,userId:d.globalData.userInfo.id,pageIndex:this.data.pageSearchIndex,pageSize:this.data.pageSize},success:function(t){t.data.result.length<e.data.pageSize?e.setData({pageSearchIndex:-1}):e.setData({pageSearchIndex:e.data.pageSearchIndex+1});var n=t.data.result,a=e.data.docList;if(n.length>0){for(var i in n)a.push(n[i]);e.setData({docList:a})}},fail:function(t){dd.alert({content:\"\\u83b7\\u53d6\\u6570\\u636e\\u5931\\u8d25\\uff0c\\u8bf7\\u91cd\\u8bd5\"})},complete:function(t){dd.hideLoading()}})},getTabs:function(){var t=this;dd.showLoading(),dd.httpRequest({url:d.globalData.host+\"api/services/app/DocCategory/GetTabChildListByIdAsync\",method:\"Get\",dataType:\"json\",data:{id:this.data.id},success:function(e){t.setData({tabs:e.data.result}),dd.hideLoading(),t.getDocList(t.data.tabs[0].id)},fail:function(t){dd.alert({content:\"\\u83b7\\u53d6\\u6570\\u636e\\u5931\\u8d25\\uff0c\\u8bf7\\u91cd\\u8bd5\"})},complete:function(t){dd.hideLoading()}})},handleClear:function(t){this.setData({pullType:\"\"})},handleInput:function(t){this.setData({input:t}),0==t.trim().length?this.setData({pullType:\"\"}):this.setData({pullType:\"search\"})},handleTabClick:function(t){var e=t.index,n=this.data.tabs[e].id;\"search\"==this.data.pullType?this.data.tempTabIndex!=e&&null!=this.data.input&&(this.setData({pageSearchIndex:1}),this.setData({tempTabIndex:e}),this.setData({id:this.data.tabs[this.data.tempTabIndex].id}),this.setData({docList:[]}),this.getSearch(n)):(this.data.tempTabIndex!=e||this.data.tempTabIndex!=e&&-1==this.data.pageIndex)&&(this.setData({pageIndex:1}),this.setData({tempTabIndex:e}),this.setData({docList:[]}),this.getDocList(this.data.tabs[this.data.tempTabIndex].id))},handleSubmit:function(t){\"search\"!=this.data.pullType?(this.setData({docList:[]}),this.setData({pageSearchIndex:1}),this.setData({pullType:\"search\"}),-1!=this.data.pageSearchIndex&&this.getSearch(this.data.tabs[this.data.tempTabIndex].id)):null!=t&&0!=t.trim().length&&(this.setData({docList:[]}),this.setData({pageSearchIndex:1}),this.setData({pullType:\"search\"}),-1!=this.data.pageSearchIndex&&this.getSearch(this.data.tabs[this.data.tempTabIndex].id))}},(0,s.default)(i,\"handleClear\",function(){this.setData({input:\"\"})}),(0,s.default)(i,\"getDocList\",function(t){var e=this;dd.showLoading(),dd.httpRequest({url:d.globalData.host+\"api/services/app/Document/GetDocListByParentIdAsync\",method:\"Get\",dataType:\"json\",data:{categoryCode:t,userId:d.globalData.userInfo.id,pageIndex:this.data.pageIndex,pageSize:this.data.pageSize},success:function(t){t.data.result.length<e.data.pageSize?e.setData({pageIndex:-1}):e.setData({pageIndex:e.data.pageIndex+1});var n=t.data.result,a=e.data.docList;if(n.length>0){for(var i in n)a.push(n[i]);e.setData({docList:a})}dd.hideLoading()},fail:function(t){dd.alert({content:\"\\u83b7\\u53d6\\u6570\\u636e\\u5931\\u8d25\\uff0c\\u8bf7\\u91cd\\u8bd5\"})},complete:function(t){dd.hideLoading()}})}),(0,s.default)(i,\"onCardClick\",function(t){dd.navigateTo({url:\"./../doc-detial/doc-detial?id=\"+t.info.id})}),(0,s.default)(i,\"onShareAppMessage\",function(){}),(0,s.default)(i,\"onReachBottom\",function(){\"search\"!=this.data.pullType?-1!=this.data.pageIndex&&this.getDocList(this.data.tabs[this.data.tempTabIndex].id):\"search\"==this.data.pullType&&-1!=this.data.pageSearchIndex&&this.getSearch()}),(0,s.default)(i,\"onUnload\",function(){dd.redirectTo({url:\"/page/kownledge/index\"})}),i))},function(t,e,n){\"use strict\";e.__esModule=!0;var a,i=n(23),o=(a=i)&&a.__esModule?a:{default:a};e.default=function(t,e,n){return e in t?(0,o.default)(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){t.exports={default:n(24),__esModule:!0}},function(t,e,n){n(25);var a=n(4).Object;t.exports=function(t,e,n){return a.defineProperty(t,e,n)}},function(t,e,n){var a=n(26);a(a.S+a.F*!n(1),\"Object\",{defineProperty:n(5).f})},function(t,e,n){var a=n(3),i=n(4),o=n(27),s=n(29),r=n(35),d=function(t,e,n){var u,c,l,p=t&d.F,f=t&d.G,h=t&d.S,g=t&d.P,b=t&d.B,m=t&d.W,v=f?i:i[e]||(i[e]={}),y=v.prototype,x=f?a:h?a[e]:(a[e]||{}).prototype;for(u in f&&(n=e),n)(c=!p&&x&&void 0!==x[u])&&r(v,u)||(l=c?x[u]:n[u],v[u]=f&&\"function\"!=typeof x[u]?n[u]:b&&c?o(l,a):m&&x[u]==l?function(t){var e=function(e,n,a){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,a)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(l):g&&\"function\"==typeof l?o(Function.call,l):l,g&&((v.virtual||(v.virtual={}))[u]=l,t&d.R&&y&&!y[u]&&s(y,u,l)))};d.F=1,d.G=2,d.S=4,d.P=8,d.B=16,d.W=32,d.U=64,d.R=128,t.exports=d},function(t,e,n){var a=n(28);t.exports=function(t,e,n){if(a(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,a){return t.call(e,n,a)};case 3:return function(n,a,i){return t.call(e,n,a,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if(\"function\"!=typeof t)throw TypeError(t+\" is not a function!\");return t}},function(t,e,n){var a=n(5),i=n(34);t.exports=n(1)?function(t,e,n){return a.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var a=n(2);t.exports=function(t){if(!a(t))throw TypeError(t+\" is not an object!\");return t}},function(t,e,n){t.exports=!n(1)&&!n(6)(function(){return 7!=Object.defineProperty(n(32)(\"div\"),\"a\",{get:function(){return 7}}).a})},function(t,e,n){var a=n(2),i=n(3).document,o=a(i)&&a(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,n){var a=n(2);t.exports=function(t,e){if(!a(t))return t;var n,i;if(e&&\"function\"==typeof(n=t.toString)&&!a(i=n.call(t)))return i;if(\"function\"==typeof(n=t.valueOf)&&!a(i=n.call(t)))return i;if(!e&&\"function\"==typeof(n=t.toString)&&!a(i=n.call(t)))return i;throw TypeError(\"Can't convert object to primitive value\")}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){\"use strict\";var a=n(0);a.bridge,a.bridge;a.$global.currentPageConfig={pagePath:\"page/kownledge/doc-detial/doc-detial\",usingComponents:{grid:\"/mini-ddui/es/grid/index\",card:\"/mini-ddui/es/card/index\",list:\"/mini-ddui/es/list/index\",\"list-item\":\"/mini-ddui/es/list/list-item/index\"}};var i=(0,a.getApp)();(0,a.Page)({data:{id:null,docInfo:{},hasPermission:!1},onLoad:function(t){t.id&&(this.setData({id:t.id}),this.getDocHasPermission())},getDocHasPermission:function(){var t=this;dd.showLoading(),dd.httpRequest({url:i.globalData.host+\"api/services/app/Document/GetHasDocPermissionFromScanAsync\",method:\"Get\",dataType:\"json\",data:{id:this.data.id,userId:i.globalData.userInfo.id},success:function(e){dd.hideLoading(),t.setData({hasPermission:e.data.result}),t.data.hasPermission&&t.getDocInfoByQrCode()},fail:function(t){dd.alert({content:\"\\u83b7\\u53d6\\u6570\\u636e\\u5931\\u8d25\\uff0c\\u8bf7\\u91cd\\u8bd5\"})},complete:function(t){dd.hideLoading()}})},getDocInfoByQrCode:function(){var t=this;dd.showLoading(),dd.httpRequest({url:i.globalData.host+\"api/services/app/Document/GetDocInfoByScanAsync\",method:\"Get\",dataType:\"json\",data:{id:this.data.id,host:i.globalData.host},success:function(e){t.setData({docInfo:e.data.result})},fail:function(t){dd.alert({content:\"\\u83b7\\u53d6\\u6570\\u636e\\u5931\\u8d25\\uff0c\\u8bf7\\u91cd\\u8bd5\"})},complete:function(t){dd.hideLoading()}})},onItemClick:function(t){var e=t.index,n=this.data.docInfo.fileList[e].fileUrl,a=this.data.docInfo.fileList[e].text;dd.saveFileToDingTalk({url:n,name:a,success:function(t){dd.previewFileInDingTalk({corpId:i.globalData.corpId,spaceId:t.data[0].spaceId,fileId:t.data[0].fileId,fileName:t.data[0].fileName,fileSize:t.data[0].fileSize,fileType:t.data[0].fileType})}})},onShareAppMessage:function(){}})}]);","extractedComments":[]}